<html>
    <head>
        <script type="text/javascript" src="src/renderer.js"></script>
        <script type="text/javascript" src="src/TicTacToe.js"></script>
        <script type="text/javascript" src="src/RandomAI.js"></script>
        <script type="text/javascript" src="src/util.js"></script>
        <script type="text/javascript">
            window.addEventListener('load', function() {
                var canvas = document.querySelector('canvas.viewport');
                var ctx = canvas.getContext('2d');
                var renderer = Renderer(ctx);
                var screenToWorld = util.getScreenToWorld(100, 15)

                var game = TicTacToe();
                var ai = RandomAI();

                var button = document.querySelector("button.restart");
                button.addEventListener('click', function() {
                    game = TicTacToe();
                    renderer.render(game.getField());
                    button.style.visibility = 'hidden';
                });

                button.style.visibility = 'hidden';
                

                renderer.render(game.getField());

                canvas.addEventListener('mouseup', function(e) {
                    var coord = {
                        x : e.pageX - canvas.offsetLeft,
                        y : e.pageY - canvas.offsetTop
                    };

                    var space = screenToWorld(coord.x, coord.y);


                    if (space !== null) {
                        var row = space[0];
                        var col = space[1];

                        game.put([row, col]);

                        if (!game.isOver()) {
                            ai.move(game);
                        };

                        if (game.isOver()) {
                            button.style.visibility = 'visible';
                        }

                    renderer.render(game.getField());
                    }
                });

            });
        </script>
    </head>
    <body>
        <canvas class="viewport" width="345" height="345"></canvas>
        <button class="restart">Restart</button>
    </body>
</html>

